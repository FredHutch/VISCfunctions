% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/statistical_tests_and_estimates.R
\name{cor_test}
\alias{cor_test}
\title{Correlation Test for Two Continuous Variables}
\usage{
cor_test(
  x,
  y,
  method = c("pearson", "kendall", "spearman"),
  seed = 68954857,
  nresample = 10000,
  exact = TRUE,
  verbose = FALSE,
  ...
)
}
\arguments{
\item{x}{numeric vector (can include NA values).}

\item{y}{numeric vector (can include NA values).}

\item{method}{a character string indicating which correlation coefficient
is to be used for the test. One of "pearson", "kendall", or "spearman",
can be abbreviated to "p", "k", or "s".}

\item{seed}{seed (only used if \code{method = "spearman"}).}

\item{nresample}{a positive integer, the number of Monte Carlo replicates
used for the computation of the approximative reference distribution.
Defaults to 10000. (only used if \code{method = "spearman"}).}

\item{exact}{should exact method be used. Ignored if
\code{method = "pearson"} or if \code{method = "spearman"} and there are
ties in x or y.}

\item{verbose}{a logical variable indicating if warnings and messages
should be displayed.}

\item{...}{parameters passed to \code{stats::cor.test} or \code{coin:spearman_test}}
}
\value{
correlation estimate p value.
}
\description{
This function is a wrapper for \code{stats::cor.test} function, except if
\code{method = "spearman"} is selected and there are ties in at least one
variable, in which case this is a wrapper for \code{coin::spearman_test}
employing the approximate method.
}
\details{
The three methods each estimate the association between paired samples and
compute a test of the value being zero. They use different measures of
association, all in the range [-1, 1] with 0 indicating no association.
These are sometimes referred to as tests of no correlation,
but that term is often confined to the default method.

If method is "pearson", the test statistic is based on Pearson's product
moment correlation coefficient cor(x, y) and follows a t distribution with
length(x)-2 degrees of freedom if the samples follow independent normal
distributions. If there are at least 4 complete pairs of observation, an
asymptotic confidence interval is given based on Fisher's Z transform.

If method is "kendall" or "spearman", Kendall's tau or Spearman's rho
statistic is used to estimate a rank-based measure of association. These
tests may be used if the data do not necessarily come from a bivariate
normal distribution.

The preferred method for a Spearman test is using the exact method, unless
computation time is too high. This
preferred method is obtained though \code{stats::cor.test} with \code{exact = TRUE}.
When there are ties in either variable there is no exact method possible.
Unfortunately if there are any ties the \code{stats::cor.test} function switches
to the asymptotic method, which is especially troubling with small sample
sizes. If there are ties \code{cor_test} will switch to the approximate
method available in the \code{coin::spearman_test}.
}
\examples{

set.seed(5432322)
x <- rnorm(20,0,3)
y <- x + rnorm(20,0,5)
cor_test(x,y, method = 'pearson')
cor_test(x,y, method = 'kendall')
cor_test(x,y, method = 'spearman')
# Adding ties
cor_test(c(x,x), c(y,y), method = 'spearman',
         seed = 1, nresample = 10000, verbose = TRUE)

}
